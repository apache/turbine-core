<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 21 December 2015 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Apache Turbine - 
  Turbine Services - Pull Service</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20151221" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href="../../../" id="bannerLeft" title="Apache Turbine">
                                                <img src="../images/turbine-project.png" alt="Apache Turbine" />
                </a>
                          <div id="bannerRight">
                                                <img src="../images/logo.gif" alt="Apache Turbine" />
                </div>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 21 December 2015</span>
                  &nbsp;| <span id="projectVersion">Version: 4.0-M2</span>
                      </div>
            <div class="xright">                    <a href="http://www.apache.org" class="externalLink" title="Apache">Apache</a>
            |
                        <a href="../../../" title="Turbine">Turbine</a>
            |
                        <a href="../../../fulcrum/" title="Fulcrum">Fulcrum</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>General Information</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../features.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="../fsd.html" title="Specification">Specification</a>
            </li>
                  <li class="none">
                          <a href="../getting-started.html" title="Getting Started">Getting Started</a>
            </li>
                  <li class="none">
                          <a href="../how-to-build.html" title="Howto Build Turbine">Howto Build Turbine</a>
            </li>
                  <li class="none">
                          <a href="../changes-report.html" title="Changes">Changes</a>
            </li>
          </ul>
                       <h5>Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="../services/index.html" title="Services">Services</a>
                    <ul>
                      <li class="none">
                          <a href="../services/assemblerbroker-service.html" title="Assembler Broker Service">Assembler Broker Service</a>
            </li>
                      <li class="none">
                          <a href="../services/avalon-component-service.html" title="Avalon Component Service">Avalon Component Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-crypto/" title="Crypto Service">Crypto Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-cache/" title="Cache Service">Cache Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-factory/" title="Factory Service">Factory Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-intake/" title="Intake Service">Intake Service</a>
            </li>
                      <li class="none">
                          <a href="../services/jsonrpc-service.html" title="JSON-RPC Service">JSON-RPC Service</a>
            </li>
                      <li class="none">
                          <a href="../services/jsp-service.html" title="JSP Service">JSP Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-localization/" title="Localization Service">Localization Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-mimetype/" title="MimeType Service">MimeType Service</a>
            </li>
                      <li class="none">
                          <a href="../services/naming-service.html" title="Naming Service">Naming Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-parser/" title="Parser Service">Parser Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-pool/" title="Pool Service">Pool Service</a>
            </li>
                      <li class="none">
            <strong>Pull Service</strong>
          </li>
                      <li class="none">
                          <a href="../services/rundata-service.html" title="RunData Service">RunData Service</a>
            </li>
                      <li class="none">
                          <a href="../services/scheduler-service.html" title="Scheduler Service">Scheduler Service</a>
            </li>
                      <li class="none">
                          <a href="../services/security-service.html" title="Security Service">Security Service</a>
            </li>
                      <li class="none">
                          <a href="../services/servlet-service.html" title="Servlet Service">Servlet Service</a>
            </li>
                      <li class="none">
                          <a href="../services/session-service.html" title="Session Service">Session Service</a>
            </li>
                      <li class="none">
                          <a href="../services/template-service.html" title="Template Service">Template Service</a>
            </li>
                      <li class="none">
                          <a href="../services/ui-service.html" title="UI Service">UI Service</a>
            </li>
                      <li class="none">
                          <a href="../services/uniqueid-service.html" title="Unique ID Service">Unique ID Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-upload/" title="Upload Service">Upload Service</a>
            </li>
                      <li class="none">
                          <a href="../services/velocity-service.html" title="Velocity Service">Velocity Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-xmlrpc/" title="XML-RPC Service">XML-RPC Service</a>
            </li>
                      <li class="none">
                          <a href="../../../fulcrum/fulcrum-xslt/" title="XSLT Service">XSLT Service</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="../howto/index.html" title="Howtos">Howtos</a>
                  </li>
                  <li class="none">
                          <a href="http://wiki.apache.org/turbine/FrontPage" class="externalLink" title="Wiki">Wiki</a>
            </li>
                  <li class="none">
                          <a href="../apidocs/index.html" title="JavaDocs">JavaDocs</a>
            </li>
          </ul>
                       <h5>Development</h5>
                  <ul>
                  <li class="none">
                          <a href="../proposals.html" title="Proposals">Proposals</a>
            </li>
                  <li class="none">
                          <a href="../how-to-help.html" title="How To Help">How To Help</a>
            </li>
                  <li class="none">
                          <a href="../todo.html" title="Todo">Todo</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                       <h5>Apache</h5>
                  <ul>
                  <li class="none">
                          <a href="http://www.apache.org/" class="externalLink" title="Apache Website">Apache Website</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/licenses/" class="externalLink" title="License">License</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How the ASF works">How the ASF works</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsorship">Sponsorship</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">Thanks</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/security/" class="externalLink" title="Security">Security</a>
            </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Licensed to the Apache Software Foundation (ASF) under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing,
 software distributed under the License is distributed on an
 "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, either express or implied.  See the License for the
 specific language governing permissions and limitations
 under the License. -->

 

<div class="section">
<h2>Pull Service<a name="Pull_Service"></a></h2>


<p>
The Pull service places tool objects in the Velocity context for use by
template engineers. It can handle tools with various different &quot;scopes&quot;,
namely:

</p>
<ul>

<li>
request-scope tools for which a new instance is needed for each
request.
</li>


<li>global-scope tools for which a single instance can serve the
entire application.
</li>


<li>
session-scope tools which are persisted as part of
the user object in the servlet engine provided session object.
</li>


<li>
persistent-scope tools which are persisted as part of the user's
serialized object data.
</li>
</ul>




<p>
The service must be enabled in TurbineResources.properties as shown
below, and tools are listed there. The default properties file lists
some request-scope tools that are needed for basic Turbine usage
($page, $link and $content), plus the useful UIManager global tool.
</p>

</div>


<div class="section">
<h2>Configuration<a name="Configuration"></a></h2>


<div class="source">
<pre>
# -------------------------------------------------------------------
#
#  S E R V I C E S
#
# -------------------------------------------------------------------
# Classes for Turbine Services should be defined here.
# Format: services.[name].classname=[implementing class]
#
# To specify properties of a service use the following syntax:
# service.[name].[property]=[value]

services.PullService.classname=org.apache.turbine.services.pull.TurbinePullService
.
.
.
# -------------------------------------------------------------------
#
#  P U L L  S E R V I C E
#
# -------------------------------------------------------------------
# These are the properties for the Pull Service, the service
# that works in conjuction with the Turbine Pull Model API.
# -------------------------------------------------------------------

# This determines whether the non-request tools are refreshed
# on each request (request tools aren't ever, because they're
# instantiated for the request only anyway).
services.PullService.tools.per.request.refresh=true

# These are tools that are placed in the context by the service
# These tools will be made available to all your
# templates. You list the tools in the following way:
#
# tool.&lt;scope&gt;.&lt;id&gt; = &lt;classname&gt;
#
# &lt;scope&gt;      is the tool scope: global, request, session,
#              authorized or persistent (see below for more details)
# &lt;id&gt;         is the name of the tool in the context
#
# For example:
#
# tool.global.ui    = org.apache.turbine.util.pull.UIManager
# tool.global.mm    = org.apache.turbine.util.pull.MessageManager
# tool.request.link = org.apache.turbine.services.pull.tools.TemplateLink
# tool.request.page = org.apache.turbine.util.template.TemplatePageAttributes
#
# (the next two examples specify mythical classes)
#
# tool.session.basket = org.sample.tools.ShoppingBasket
# tool.persistent.ui  = org.sample.tools.PersistentUIManager
#
#
# Tools are accessible in all templates by the &lt;id&gt; given
# to the tool. So for the above listings the UIManager would
# be available as $ui, the MessageManager as $mm, the TemplateLink
# as $link and the TemplatePageAttributes as $page.
#
# Scopes:
#
#   global:    tool is instantiated once and that instance is available
#              to all templates for all requests. Tool must be threadsafe.
#
#   request:    tool is instantiated once for each request (although the
#               PoolService is used to recycle instances). Tool need not
#               be threadsafe.
#
#   session:    tool is instantiated once for each user session, and is
#               stored in the user's temporary hashtable. Tool should be
#               threadsafe.
#
# authorized: tool is instantiated once for each user session once the
#             user logs in. After this, it is a normal session tool.
#
# persistent: tool is instantitated once for each user session once
#             the user logs in and is is stored in the user's permanent
#             hashtable.
#             This means for a logged in user the tool will be persisted
#             in the user's objectdata. Tool should be threadsafe and
#             Serializable.
#
# Defaults: none

tool.request.link=org.apache.turbine.services.pull.tools.TemplateLink
tool.request.page=org.apache.turbine.util.template.TemplatePageAttributes
tool.request.content=org.apache.turbine.services.pull.tools.ContentTool
#tool.request.om=org.apache.turbine.om.OMTool
#tool.request.intake=org.apache.turbine.services.intake.IntakeTool

tool.global.ui=org.apache.turbine.services.pull.util.UIManager

# The UI Manager will allow you to skin your Turbine
# application using simple properties files that are
# located in the WEBAPP/resources/ui/skins/ directory
# hierarchy.

tool.ui.skin=default

</pre></div>

</div>


<div class="section">
<h2>Usage<a name="Usage"></a></h2>


<p>
The first step in use of the pull service is deciding on a useful
tool API for an object that is available to templates in the
Velocity context. This could range from something as simple as
the generation of URIs ($link and $content) to a tool for retrieving
details of the user's current shopping basket. Define a set of
public methods for the tool and they will be available through
standard Velocity introspection.
</p>


<p>
The next step is to decide what scope you need to give the tool.
If the tool is retrieving global data in a threadsafe manner, you
can make the tool global. If the tool holds data specific to the
user look at the session, authorized  and persistent scopes
(choose persistent for a convenient way of having the tools fields
persisted across sessions for logged in users). If the tool needs to
be instantiated on each request to fulfill its function, or is not
threadsafe, then the request scope will be appropriate.
</p>


<p>
Tools can implement the org.apache.turbine.services.pull.ApplicationTool
or the org.apache.turbine.services.pull.RunDataApplicationTool
interface. This will provide a hook for the service to initialise them
through the 'init' method and, except for request scope tools, to be
refreshed through the 'refresh' method. The type of the init argument
'data' (declared as type 'Object') depends on the scope of the tool.
For global tools the argument will be null; for session and persistent
scope tools, 'data' will be the current User object; and for request
scope tools 'data' will be the current RunData instance.
</p>


<p>
If you activate the RefreshToolsPerRequest property, every tool is
refreshed on each request. On Request Tools this makes no difference,
because here, the refresh() is never called (they're instantiated on
every request).  All other scopes get a call to refresh() on every
request. If you chose to implement the RunDataApplicationTool interface,
you get the current RunData object passed to your tool.
</p>


<p>
Important note: request scope tools are recycled by the PoolService.
This means they must be written to be reused. This usually means
implementing the ApplicationTool interface, and having the 'init'
implementation reset all fields.
</p>


<p>
Current examples of tools include the afore mentioned $link, $page and
$content objects, the $ui UI manager, the Intake service tool
(org.apache.turbine.services.intake.IntakeTool) and the OM tool
(org.apache.turbine.om.OMTool).
</p>

</div>



      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2000-2015
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>