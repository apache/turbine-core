<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Turbine - Turbine Services - Pull Service</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Sean Legassick"></meta><meta name="email" content="sean@informage.net"></meta><meta name="author" content="Henning P. Schmiedehausen"></meta><meta name="email" content="hps@intermeta.de"></meta><meta name="author" content="Scott Eade"></meta><meta name="email" content="seade@backstagetech.com.au"></meta></head><body class="composite"><div id="banner"><a href="http://turbine.apache.org/" id="organizationLogo"><img alt="Apache Software Foundation" src="../images/turbine-project.png"></img></a><a href="http://turbine.apache.org/turbine/turbine-2.3.3/index.html" id="projectLogo"><img alt="turbine-2" src="../images/logo.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 21 November 2008
                <span class="separator">|</span> Doc for  2.3.3
                </div><div class="xright">
        
        <a href="http://turbine.apache.org/">Turbine Home</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/fulcrum/">Fulcrum</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/meta/">META</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuGeneral_Information"><h5>General Information</h5><ul><li class="none"><a href="../index.html">Overview</a></li><li class="none"><a href="../features.html">Features</a></li><li class="none"><a href="../fsd.html">Specification</a></li><li class="none"><a href="../getting-started.html">Getting Started</a></li></ul></div><div id="menuDocumentation"><h5>Documentation</h5><ul><li class="none"><a href="../changes-report.html">Changes</a></li><li class="none"><a href="../turbine-schema.html">Core DB Schema</a></li><li class="expanded"><a href="../services/index.html">Services</a><ul><li class="none"><a href="../services/assemblerbroker-service.html">Assembler Broker Service</a></li><li class="none"><a href="../services/avalon-component-service.html">Avalon Component Service</a></li><li class="none"><a href="../services/crypto-service.html">Crypto Service</a></li><li class="none"><a href="../services/cache-service.html">Cache Service</a></li><li class="none"><a href="../services/factory-service.html">Factory Service</a></li><li class="none"><a href="../services/intake-service.html">Intake Service</a></li><li class="none"><a href="../services/jsonrpc-service.html">JSON-RPC Service</a></li><li class="none"><a href="../services/jsp-service.html">JSP Service</a></li><li class="none"><a href="../services/localization-service.html">Localization Service</a></li><li class="none"><a href="../services/logging-service.html">Logging Service</a></li><li class="none"><a href="../services/mimetype-service.html">MimeType Service</a></li><li class="none"><a href="../services/naming-service.html">Naming Service</a></li><li class="none"><a href="../services/pool-service.html">Pool Service</a></li><li class="none"><strong><a href="../services/pull-service.html">Pull Service</a></strong></li><li class="none"><a href="../services/resources-service.html">Resources Service</a></li><li class="none"><a href="../services/rundata-service.html">RunData Service</a></li><li class="none"><a href="../services/scheduler-service.html">Scheduler Service</a></li><li class="expanded"><a href="../services/security-service.html">Security Service</a><ul><li class="none"><a href="../services/ldap-security-service.html">LDAP Security Service</a></li><li class="none"><a href="../services/torque-security-service.html">Torque Security Service</a></li><li class="none"><a href="../services/torque-security-schema.html">Torque Security Service Schema</a></li></ul></li><li class="none"><a href="../services/servlet-service.html">Servlet Service</a></li><li class="none"><a href="../services/session-service.html">Session Service</a></li><li class="none"><a href="../services/template-service.html">Template Service</a></li><li class="none"><a href="../services/ui-service.html">UI Service</a></li><li class="none"><a href="../services/uniqueid-service.html">Unique ID Service</a></li><li class="none"><a href="../services/upload-service.html">Upload Service</a></li><li class="none"><a href="../services/velocity-service.html">Velocity Service</a></li><li class="none"><a href="../services/xmlrpc-service.html">XML-RPC Service</a></li><li class="none"><a href="../services/xslt-service.html">XSLT Service</a></li><li class="none"><a href="../services/yaafi-component-service.html">Yaafi Component Service</a></li></ul></li><li class="collapsed"><a href="../howto/index.html">Howtos</a></li><li class="none"><a href="../apidocs/index.html">JavaDocs</a></li></ul></div><div id="menuDevelopment"><h5>Development</h5><ul><li class="none"><a href="../proposals.html">Proposals</a></li><li class="none"><a href="../how-to-help.html">How To Help</a></li><li class="none"><a href="../todo.html">Todo</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="../development-process.html">Development Process</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/mavenlogo_builtby_w.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Pull_Service"></a><h2>Pull Service</h2>

<p>
The Pull service places tool objects in the Velocity context for use by
template engineers. It can handle tools with various different "scopes",
namely:

<ul>
<li>
request-scope tools for which a new instance is needed for each
request.
</li>

<li>global-scope tools for which a single instance can serve the
entire application.
</li>

<li>
session-scope tools which are persisted as part of
the user object in the servlet engine provided session object.
</li>

<li>
persistent-scope tools which are persisted as part of the user's
serialized object data.
</li>
</ul>

</p>

<p>
The service must be enabled and the desired tools configured in
TurbineResources.properties as shown below. The default properties file lists
some request-scope tools that are needed for basic Turbine usage
($page, $link and $content), plus the useful UITool skinning tool.
</p>

</div><div class="section"><a name="Configuration"></a><h2>Configuration</h2>


    <div class="source"><pre>
# -------------------------------------------------------------------
#
#  S E R V I C E S
#
# -------------------------------------------------------------------
# Classes for Turbine Services should be defined here.
# Format: services.[name].classname=[implementing class]
#
# To specify properties of a service use the following syntax:
# service.[name].[property]=[value]

services.PullService.classname=org.apache.turbine.services.pull.TurbinePullService
.
.
.
# -------------------------------------------------------------------
#
#  P U L L  S E R V I C E
#
# -------------------------------------------------------------------
# These are the properties for the Pull Service, the service
# that works in conjuction with the Turbine Pull Model API.
# -------------------------------------------------------------------

# This determines whether the non-request tools are refreshed
# on each request (request tools aren't ever, because they're
# instantiated for the request only anyway).
services.PullService.tools.per.request.refresh=true

# Path to the resources of the application tools, relative to the
# application root
# services.PullService.tools.resources.dir=/resources/

# These are tools that are placed in the context by the service
# These tools will be made available to all your
# templates. You list the tools in the following way:
#
# tool.&lt;scope&gt;.&lt;id&gt; = &lt;classname&gt;
#
# &lt;scope&gt;      is the tool scope: global, request, session,
#              authorized or persistent (see below for more details)
# &lt;id&gt;         is the name of the tool in the context
#
# For example:
#
# tool.global.ui    = org.apache.turbine.util.pull.tools.UITool
# tool.global.mm    = org.apache.turbine.util.pull.MessageManager
# tool.request.link = org.apache.turbine.services.pull.tools.TemplateLink
# tool.request.page = org.apache.turbine.util.template.HtmlPageAttributes
#
# (the next two examples specify mythical classes)
#
# tool.session.basket = org.sample.tools.ShoppingBasket
# tool.persistent.ui  = org.sample.tools.PersistentUIManager
#
#
# Tools are accessible in all templates by the &lt;id&gt; given
# to the tool. So for the above listings the UITool would
# be available as $ui, the MessageManager as $mm, the TemplateLink
# as $link and the HtmlPageAttributes as $page.
#
# Scopes:
#
#   global:    tool is instantiated once and that instance is available
#              to all templates for all requests. Tool must be threadsafe.
#
#   request:   tool is instantiated once for each request (although the
#              PoolService is used to recycle instances). Tool need not
#              be threadsafe.
#
#   session:   tool is instantiated once for each user session, and is
#              stored in the user's temporary hashtable. Tool should be
#              threadsafe.
#
# authorized: tool is instantiated once for each user session once the
#             user logs in. After this, it is a normal session tool.
#
# persistent: tool is instantiated once for each user session once
#             the user logs in and is is stored in the user's permanent
#             hashtable.
#             This means for a logged in user the tool will be persisted
#             in the user's objectdata. Tool should be Serializable.  These
#             tools do not need to be threadsafe.
#             &lt;b&gt;persistent scope tools are deprecated in 2.3&lt;/b&gt;
#
# Defaults: none

tool.request.link=org.apache.turbine.services.pull.tools.TemplateLink
tool.request.page=org.apache.turbine.util.template.HtmlPageAttributes
tool.request.content=org.apache.turbine.services.pull.tools.ContentTool
#tool.request.om=org.apache.turbine.om.OMTool
#tool.request.intake=org.apache.turbine.services.intake.IntakeTool

# The UITool will allow you to skin your Turbine application using simple
# properties files that are located in the WEBAPP/resources/ directory
# hierarchy.

tool.global.ui=org.apache.turbine.services.pull.tools.UITool
## See UI Service documentation for further configuration options for UITool
tool.ui.skin=default

</pre></div>
  

</div><div class="section"><a name="Usage"></a><h2>Usage</h2>

<p>
The first step in use of the pull service is deciding on a useful
tool API for an object that is available to templates in the
Velocity context. This could range from something as simple as
the generation of URIs ($link and $content) to a tool for retrieving
details of the user's current shopping basket. Define a set of
public methods for the tool and they will be available through
standard Velocity introspection.
</p>

<p>
The next step is to decide what scope you need to give the tool.
If the tool is retrieving global data in a threadsafe manner, you
can make the tool global. If the tool holds data specific to the
user look at the session and authorized scopes. If the tool needs to
be instantiated on each request to fulfill its function, or is not
threadsafe, then the request scope will be appropriate.
</p>

<p>
Tools can implement the org.apache.turbine.services.pull.ApplicationTool
or the org.apache.turbine.services.pull.RunDataApplicationTool
interface. This will provide a hook for the service to initialise them
through the 'init' method and, except for request scope tools, to be
refreshed through the 'refresh' method. The type of the init argument
'data' (declared as type 'Object') depends on the scope of the tool.
For global tools the argument will be null; for session and persistent
scope tools, 'data' will be the current User object; and for request
scope tools 'data' will be the current RunData instance.
</p>

<p>
If you activate the RefreshToolsPerRequest property, every tool is
refreshed on each request. On Request Tools this makes no difference,
because here, the refresh() is never called (they're instantiated on
every request).  All other scopes get a call to refresh() on every
request. If you chose to implement the RunDataApplicationTool interface,
you get the current RunData object passed to your tool.
</p>

<p>
Important note: request scope tools are recycled by the PoolService.
This means they must be written to be reused. This usually means
implementing the ApplicationTool interface, and having the 'init'
implementation reset all fields.
</p>

<p>
Current examples of tools include the afore mentioned $link, $page and
$content objects, the $ui UI service tool, the Intake service tool
(org.apache.turbine.services.intake.IntakeTool) and the OM tool
(org.apache.turbine.om.OMTool).
</p>

</div><div class="section"><a name="Velocity_Tools"></a><h2>Velocity Tools</h2>

<p>
The <a href="http://velocity.apache.org/tools/devel/generic/" class="externalLink" title="External Link">Velocity Tools -
Generic Tools</a> project provides a number of useful tools that can be used
with your Turbine applications.  To do this, all you need to do is to add the
relevant velocity-tools-generic jar file to your dependencies and then configure
the desired tools in your TurbineResources.properties thus:
</p>


    <div class="source"><pre>
tool.global.dateTool = org.apache.velocity.tools.generic.DateTool
tool.global.mathTool = org.apache.velocity.tools.generic.MathTool
tool.global.numberTool = org.apache.velocity.tools.generic.NumberTool
tool.global.escTool = org.apache.velocity.tools.generic.EscapeTool
tool.global.renderTool = org.apache.velocity.tools.generic.RenderTool
tool.global.sortTool = org.apache.velocity.tools.generic.SortTool
...
</pre></div>
  

</div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2000-2008, Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>