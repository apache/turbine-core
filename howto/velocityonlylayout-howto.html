<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from xdocs/howto/velocityonlylayout-howto.xml at 24 October 2022
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Apache Turbine &#x2013; VelocityOnlyLayout</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.9.min.js"></script>
<link rel="icon" type="image/png" sizes="48x48" href="./images/favicon.ico"> 
      <link rel="icon" type="image/png" sizes="48x48" href="../images/favicon.ico"> 
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/apache/turbine-core">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../../" id="bannerLeft" title="Apache Turbine"><img src="../images/turbine-project-apache-separate.png"  alt="Apache Turbine"/></a></div>
          <div class="pull-right"><div id="bannerRight"><img src="../images/logo.gif"  alt=""/></div>
</div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 24 October 2022<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 5.2-SNAPSHOT</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://turbine.apache.org/fulcrum/" class="externalLink" title="Fulcrum">Fulcrum</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://turbine.apache.org/" class="externalLink" title="Turbine">Turbine</a></li>
      <li class="pull-right"><a href="https://www.apache.org" class="externalLink" title="Apache">Apache</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">General Information</li>
    <li><a href="../index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li><a href="../features.html" title="Features"><span class="none"></span>Features</a></li>
    <li><a href="../fsd.html" title="Specification"><span class="none"></span>Specification</a></li>
    <li><a href="../getting-started.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li><a href="../how-to-build.html" title="Howto Build Turbine"><span class="none"></span>Howto Build Turbine</a></li>
    <li><a href="../changes-report.html" title="Changes"><span class="none"></span>Changes</a></li>
   <li class="nav-header">Documentation</li>
    <li><a href="../services/index.html" title="Services"><span class="icon-chevron-right"></span>Services</a></li>
    <li><a href="../howto/index.html" title="Howtos"><span class="icon-chevron-down"></span>Howtos</a>
     <ul class="nav nav-list">
      <li><a href="../howto/action-event-howto.html" title="Action Events Howto"><span class="none"></span>Action Events Howto</a></li>
      <li><a href="../howto/annotations.html" title="Annotations Howto"><span class="none"></span>Annotations Howto</a></li>
      <li><a href="../howto/configuration-howto.html" title="Configuration Howto"><span class="none"></span>Configuration Howto</a></li>
      <li><a href="../howto/extend-user-howto.html" title="Extend User Howto"><span class="none"></span>Extend User Howto</a></li>
      <li><a href="../howto/hibernate-howto.html" title="Hibernate OM Howto"><span class="none"></span>Hibernate OM Howto</a></li>
      <li><a href="../howto/intake-howto.html" title="Intake Howto"><span class="none"></span>Intake Howto</a></li>
      <li><a href="../howto/jsp-howto.html" title="JSP Howto"><span class="none"></span>JSP Howto</a></li>
      <li><a href="../howto/migrate-from-2_1-howto.html" title="Migrating from 2.1 to 2.2"><span class="none"></span>Migrating from 2.1 to 2.2</a></li>
      <li><a href="../howto/migrate-from-2_2-howto.html" title="Migrating from 2.2 to 2.3"><span class="none"></span>Migrating from 2.2 to 2.3</a></li>
      <li><a href="../howto/migrate-from-2_3-howto.html" title="Migrating from 2.3 to 4.0"><span class="none"></span>Migrating from 2.3 to 4.0</a></li>
      <li><a href="../howto/migrate-from-4_0-howto.html" title="Migrating from 4.0 to 5.0"><span class="none"></span>Migrating from 4.0 to 5.0</a></li>
      <li><a href="../howto/pullmodel-howto.html" title="Pull Model Howto"><span class="none"></span>Pull Model Howto</a></li>
      <li><a href="../howto/python-howto.html" title="Python Howto"><span class="none"></span>Python Howto</a></li>
      <li><a href="../howto/security-howto.html" title="Security Howto"><span class="none"></span>Security Howto</a></li>
      <li><a href="../howto/services-howto.html" title="Services Howto"><span class="none"></span>Services Howto</a></li>
      <li><a href="../howto/url-mapper-howto.html" title="URL Mapper Howto"><span class="none"></span>URL Mapper Howto</a></li>
      <li><a href="../howto/url-rewriting-howto.html" title="URL Rewriting Howto"><span class="none"></span>URL Rewriting Howto</a></li>
      <li><a href="../howto/context-howto.html" title="Velocity Context Howto"><span class="none"></span>Velocity Context Howto</a></li>
      <li><a href="../howto/velocity-site-howto.html" title="Velocity Site Howto"><span class="none"></span>Velocity Site Howto</a></li>
      <li class="active"><a href="#"><span class="none"></span>VelocityOnlyLayout Howto</a></li>
     </ul></li>
    <li><a href="https://cwiki.apache.org/confluence/display/TURBINE" class="externalLink" title="Wiki"><span class="none"></span>Wiki</a></li>
    <li><a href="../apidocs/index.html" title="JavaDocs"><span class="none"></span>JavaDocs</a></li>
   <li class="nav-header">Development</li>
    <li><a href="../proposals.html" title="Proposals"><span class="none"></span>Proposals</a></li>
    <li><a href="../how-to-help.html" title="How To Help"><span class="none"></span>How To Help</a></li>
    <li><a href="../todo.html" title="Todo"><span class="none"></span>Todo</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
   <li class="nav-header">Apache</li>
    <li><a href="https://www.apache.org/" class="externalLink" title="Apache Website"><span class="none"></span>Apache Website</a></li>
    <li><a href="https://www.apache.org/licenses/" class="externalLink" title="License"><span class="none"></span>License</a></li>
    <li><a href="https://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How the ASF works"><span class="none"></span>How the ASF works</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsorship"><span class="none"></span>Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks"><span class="none"></span>Thanks</a></li>
    <li><a href="https://www.apache.org/security/" class="externalLink" title="Security"><span class="none"></span>Security</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="http://turbine.apache.org/turbine-core" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script>asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >


 

<section>
<h2><a name="Introduction"></a>Introduction</h2>

<p>
    The VelocityECSLayout has been deprecated in Turbine 2.3. This document
    is intended to help you convert your application to use the
    VelocityOnlyLayout.
</p>

<p>
    The VelocityOnlyLayout does not use ECS to generate the HTML page for
    you. This also means that the current $page pull tool will not work with
    the VelocityOnlyLayout. You will be responsible for constructing the HTML,
    HEAD, BODY, etc. tags using Velocity.
</p>

<p>
    Although this seems like a lot of trouble, it really isn't. All that you
    really need to do is modify your layout templates. You will still use the
    $page pull tool just like before. Your layout templates will also use the
    $page pull tool to extract the data needed to build the HEAD and BODY
    tags.
</p>
</section>

<section>
<h2><a name="Changes_to_make_in_TR.props"></a>Changes to make in TR.props</h2>

<p>
    Changes the definition of the $page pull tool:
</p>

<div class="source"><pre class="prettyprint">

tool.request.page = org.apache.turbine.util.template.HtmlPageAttributes

</pre></div>

<p>
	Change the default layout
</p>

<div class="source"><pre class="prettyprint">

services.VelocityService.default.layout = VelocityOnlyLayout

</pre></div>

</section>

<section>
<h2><a name="Changes_to_your_code"></a>Changes to your code</h2>

<p>
  </p>
<ul>
  	
<li>$page.addAttribute(attribute,value) has been replaced with
  	    $page.addBodyAttribute(attribute,value)</li>
  	
<li>$page.setScript(url) has been replaced with
  	    $page.addScript(url)</li>
  	
<li>$page.setStyleSheet(url) has been replaced with
  	    $page.addStyleSheet(url)</li>
  	
<li>$page.setStyle(styleText) has been replaced with
  	    $page.addStyle(styleText)</li>
  	
<li>$page.setStyleSheet(url,media) has been replaced with
  	    $page.addStyleSheet(url,media,title,type)</li>
  </ul>


<p>
    <i>Use of any of the deprecated methods will generate a log message
    at the info level.</i>
</p>

<p>
    Add the line
</p>

<div class="source"><pre class="prettyprint">

$page.DefaultDoctype

</pre></div>

<p>
    to your layout templates to pick up the default doctype definition from
    TurbineResources.properties thus:
</p>

<div class="source"><pre class="prettyprint">

# Set the components of the default Doctype for use in html documents.
#
# Defaults: There are no defaults - if default.html.doctype.root.element is not
#           set then no default doctype will be available.

default.html.doctype.root.element=HTML
default.html.doctype.identifier=-//W3C//DTD HTML 4.01 Transitional//EN
default.html.doctype.url=http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd

</pre></div>

<p>
    Add the line
</p>

<div class="source"><pre class="prettyprint">

services.VelocityService.velocimacro.library = macros/TurbineMacros.vm

</pre></div>

<p>
    to your TurbineResources.properties and it will pick up the
    TurbineMacros.vm in your Turbine jar. An example of how to use
    these macros follows.
</p>

<p>
    Here is a sample layout template that you can use:
</p>

<div class="source"><pre class="prettyprint">

    ## Set defaults for all pages using this layout.  Anything set here can
    ## be overridden in the screen template.
    $page.setTitle(&quot;My default page title&quot;);
    $page.setHttpEquiv(&quot;Content-Style-Type&quot;,&quot;text/css&quot;)
    $page.addStyleSheet($content.getURI(&quot;myStyleSheet.css&quot;))
    $page.addScript($content.getURI(&quot;globalJavascriptCode.js&quot;))
    ## build the HTML, HEAD, and BODY tags dynamically

    $page.DefaultDoctype
    &lt;html&gt;
      #TurbineHtmlHead()
      &lt;body #TurbineHtmlBodyAttributes() &gt;
      $navigation.setTemplate(&quot;default_header.vm&quot;)
      $screen_placeholder
      $navigation.setTemplate(&quot;default_footer.vm&quot;)

      &lt;/body&gt;
    &lt;/html&gt;

</pre></div>

<p>
    This produces the same code as the following sample layout
    template that you can use:
</p>
	
<div class="source"><pre class="prettyprint">

    ## Set defaults for all pages using this layout.  Anything set here can
    ## be overridden in the screen template.
    $page.setTitle(&quot;My default page title&quot;);
    $page.setHttpEquiv(&quot;Content-Style-Type&quot;,&quot;text/css&quot;)
    $page.addStyleSheet($content.getURI(&quot;myStyleSheet.css&quot;))
    $page.addScript($content.getURI(&quot;globalJavascriptCode.js&quot;))
    ## build the HTML, HEAD, and BODY tags dynamically

    $page.DefaultDoctype
    &lt;html&gt;
      &lt;head&gt;
        #if($page.Title != &quot;&quot;)
        &lt;title&gt;$page.Title&lt;/title&gt;
        #end
        #foreach($metaTag in $page.MetaTags.keySet())
        &lt;meta name=&quot;$metaTag&quot; content=&quot;$page.MetaTags.get($metaTag)&quot;&gt;
        #end
        #foreach($httpEquiv in $page.HttpEquivs.keySet())
        &lt;meta http-equiv=&quot;$httpEquiv&quot; content=&quot;$page.HttpEquivs.get($httpEquiv)&quot;&gt;
        #end
        #foreach($styleSheet in $page.StyleSheets)
          &lt;link rel=&quot;stylesheet&quot; href=&quot;$styleSheet.Url&quot;
            #if($styleSheet.Type != &quot;&quot; ) type=&quot;$styleSheet.Type&quot; #end
            #if($styleSheet.Media != &quot;&quot;) media=&quot;$styleSheet.Media&quot; #end
            #if($styleSheet.Title != &quot;&quot;) title=&quot;$styleSheet.Title&quot; #end
          &gt;
        #end
        #if ($page.Styles.size() &gt; 0)
          &lt;style type=&quot;text/css&quot;&gt;
          #foreach( $style in $page.Styles )
            $!style
          #end
          &lt;/style&gt;
        #end
        #foreach($script in $page.Scripts)
          &lt;script type=&quot;text/javascript&quot; src=&quot;$script&quot; language=&quot;JavaScript&quot;&gt;&lt;/script&gt;
        #end
      &lt;/head&gt;

      ## Construct the body tag.  Iterate through the body attributes to build the opening tag
      &lt;body
        #foreach($attributeName in $page.BodyAttributes.keySet())
          $attributeName = &quot;$page.BodyAttributes.get($attributeName)&quot;
        #end
      &gt;

      $navigation.setTemplate(&quot;default_header.vm&quot;)
      $screen_placeholder
      $navigation.setTemplate(&quot;default_footer.vm&quot;)

      &lt;/body&gt;
    &lt;/html&gt;

</pre></div>
</section>

<section>
<h2><a name="Writing_Directly_To_ServletOutputStream"></a>Writing Directly To ServletOutputStream</h2>

<p>
    See
	<a class="externalLink" href="http://wiki.apache.org/turbine/Turbine2/VelocityOnlyLayout">
	VelocityOnlyLayout</a> on the Turbine wiki for some information concerning
	writing directly to ServletOutputStream.
</p>
</section>

<section>
<h2><a name="Updates_to_this_document"></a>Updates to this document</h2>

<p>
    This document is by no means complete or totally accurate. We welcome
    suggestions as to how it might be improved, particularly if you have
    just completed updating an application by following this howto.
</p>
</section>



        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2000&#x2013;2022
<a href="https://www.apache.org/">The Apache Software Foundation</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
