<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from xdocs/howto\velocityonlylayout-howto.xml at 18 June 2019 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Apache Turbine &#x2013; VelocityOnlyLayout</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<a href="../../../" id="bannerLeft" title="Apache Turbine"><img src="../images/turbine-project-apache-separate.png"  alt="Apache Turbine"/></a>
<div id="bannerRight">
<img src="../images/logo.gif"  alt=""/></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 18 June 2019</span>
          &nbsp;| <span id="projectVersion">Version: 5.1-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="http://www.apache.org" class="externalLink" title="Apache">Apache</a> |
<a href="../../../" title="Turbine">Turbine</a> |
<a href="../../../fulcrum/" title="Fulcrum">Fulcrum</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>General Information</h5>
    <ul>
     <li class="none"><a href="../index.html" title="Overview">Overview</a></li>
     <li class="none"><a href="../features.html" title="Features">Features</a></li>
     <li class="none"><a href="../fsd.html" title="Specification">Specification</a></li>
     <li class="none"><a href="../getting-started.html" title="Getting Started">Getting Started</a></li>
     <li class="none"><a href="../how-to-build.html" title="Howto Build Turbine">Howto Build Turbine</a></li>
     <li class="none"><a href="../changes-report.html" title="Changes">Changes</a></li>
    </ul>
       <h5>Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../services/index.html" title="Services">Services</a></li>
     <li class="expanded"><a href="../howto/index.html" title="Howtos">Howtos</a>
      <ul>
       <li class="none"><a href="../howto/action-event-howto.html" title="Action Events Howto">Action Events Howto</a></li>
       <li class="none"><a href="../howto/annotations.html" title="Annotations Howto">Annotations Howto</a></li>
       <li class="none"><a href="../howto/configuration-howto.html" title="Configuration Howto">Configuration Howto</a></li>
       <li class="none"><a href="../howto/extend-user-howto.html" title="Extend User Howto">Extend User Howto</a></li>
       <li class="none"><a href="../howto/hibernate-howto.html" title="Hibernate OM Howto">Hibernate OM Howto</a></li>
       <li class="none"><a href="../howto/intake-howto.html" title="Intake Howto">Intake Howto</a></li>
       <li class="none"><a href="../howto/jsp-howto.html" title="JSP Howto">JSP Howto</a></li>
       <li class="none"><a href="../howto/migrate-from-2_1-howto.html" title="Migrating from 2.1 to 2.2">Migrating from 2.1 to 2.2</a></li>
       <li class="none"><a href="../howto/migrate-from-2_2-howto.html" title="Migrating from 2.2 to 2.3">Migrating from 2.2 to 2.3</a></li>
       <li class="none"><a href="../howto/migrate-from-2_3-howto.html" title="Migrating from 2.3 to 4.0">Migrating from 2.3 to 4.0</a></li>
       <li class="none"><a href="../howto/migrate-from-4_0-howto.html" title="Migrating from 4.0 to 5.0">Migrating from 4.0 to 5.0</a></li>
       <li class="none"><a href="../howto/pullmodel-howto.html" title="Pull Model Howto">Pull Model Howto</a></li>
       <li class="none"><a href="../howto/python-howto.html" title="Python Howto">Python Howto</a></li>
       <li class="none"><a href="../howto/security-howto.html" title="Security Howto">Security Howto</a></li>
       <li class="none"><a href="../howto/services-howto.html" title="Services Howto">Services Howto</a></li>
       <li class="none"><a href="../howto/url-rewriting-howto.html" title="URL rewriting Howto">URL rewriting Howto</a></li>
       <li class="none"><a href="../howto/context-howto.html" title="Velocity Context Howto">Velocity Context Howto</a></li>
       <li class="none"><a href="../howto/velocity-site-howto.html" title="Velocity Site Howto">Velocity Site Howto</a></li>
       <li class="none"><strong>VelocityOnlyLayout Howto</strong></li>
      </ul></li>
     <li class="none"><a href="http://wiki.apache.org/turbine/FrontPage" class="externalLink" title="Wiki">Wiki</a></li>
     <li class="none"><a href="../apidocs/index.html" title="JavaDocs">JavaDocs</a></li>
    </ul>
       <h5>Development</h5>
    <ul>
     <li class="none"><a href="../proposals.html" title="Proposals">Proposals</a></li>
     <li class="none"><a href="../how-to-help.html" title="How To Help">How To Help</a></li>
     <li class="none"><a href="../todo.html" title="Todo">Todo</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../project-info.html" title="Project Information">Project Information</a></li>
     <li class="collapsed"><a href="../project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
       <h5>Apache</h5>
    <ul>
     <li class="none"><a href="http://www.apache.org/" class="externalLink" title="Apache Website">Apache Website</a></li>
     <li class="none"><a href="http://www.apache.org/licenses/" class="externalLink" title="License">License</a></li>
     <li class="none"><a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How the ASF works">How the ASF works</a></li>
     <li class="none"><a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsorship">Sponsorship</a></li>
     <li class="none"><a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">Thanks</a></li>
     <li class="none"><a href="http://www.apache.org/security/" class="externalLink" title="Security">Security</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">


 

<div class="section">
<h2><a name="Introduction"></a>Introduction</h2>

<p>
    The VelocityECSLayout has been deprecated in Turbine 2.3. This document
    is intended to help you convert your application to use the
    VelocityOnlyLayout.
</p>

<p>
    The VelocityOnlyLayout does not use ECS to generate the HTML page for
    you. This also means that the current $page pull tool will not work with
    the VelocityOnlyLayout. You will be responsible for constructing the HTML,
    HEAD, BODY, etc. tags using Velocity.
</p>

<p>
    Although this seems like a lot of trouble, it really isn't. All that you
    really need to do is modify your layout templates. You will still use the
    $page pull tool just like before. Your layout templates will also use the
    $page pull tool to extract the data needed to build the HEAD and BODY
    tags.
</p>
</div>


<div class="section">
<h2><a name="Changes_to_make_in_TR.props"></a>Changes to make in TR.props</h2>

<p>
    Changes the definition of the $page pull tool:
</p>

<div class="source">
<pre>

tool.request.page = org.apache.turbine.util.template.HtmlPageAttributes

</pre></div>

<p>
	Change the default layout
</p>

<div class="source">
<pre>

services.VelocityService.default.layout = VelocityOnlyLayout

</pre></div>

</div>


<div class="section">
<h2><a name="Changes_to_your_code"></a>Changes to your code</h2>

<p>
  </p>
<ul>
  	
<li>$page.addAttribute(attribute,value) has been replaced with
  	    $page.addBodyAttribute(attribute,value)</li>
  	
<li>$page.setScript(url) has been replaced with
  	    $page.addScript(url)</li>
  	
<li>$page.setStyleSheet(url) has been replaced with
  	    $page.addStyleSheet(url)</li>
  	
<li>$page.setStyle(styleText) has been replaced with
  	    $page.addStyle(styleText)</li>
  	
<li>$page.setStyleSheet(url,media) has been replaced with
  	    $page.addStyleSheet(url,media,title,type)</li>
  </ul>


<p>
    <i>Use of any of the deprecated methods will generate a log message
    at the info level.</i>
</p>

<p>
    Add the line
</p>

<div class="source">
<pre>

$page.DefaultDoctype

</pre></div>

<p>
    to your layout templates to pick up the default doctype definition from
    TurbineResources.properties thus:
</p>

<div class="source">
<pre>

# Set the components of the default Doctype for use in html documents.
#
# Defaults: There are no defaults - if default.html.doctype.root.element is not
#           set then no default doctype will be available.

default.html.doctype.root.element=HTML
default.html.doctype.identifier=-//W3C//DTD HTML 4.01 Transitional//EN
default.html.doctype.url=http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd

</pre></div>

<p>
    Add the line
</p>

<div class="source">
<pre>

services.VelocityService.velocimacro.library = macros/TurbineMacros.vm

</pre></div>

<p>
    to your TurbineResources.properties and it will pick up the
    TurbineMacros.vm in your Turbine jar. An example of how to use
    these macros follows.
</p>

<p>
    Here is a sample layout template that you can use:
</p>

<div class="source">
<pre>

    ## Set defaults for all pages using this layout.  Anything set here can
    ## be overridden in the screen template.
    $page.setTitle(&quot;My default page title&quot;);
    $page.setHttpEquiv(&quot;Content-Style-Type&quot;,&quot;text/css&quot;)
    $page.addStyleSheet($content.getURI(&quot;myStyleSheet.css&quot;))
    $page.addScript($content.getURI(&quot;globalJavascriptCode.js&quot;))
    ## build the HTML, HEAD, and BODY tags dynamically

    $page.DefaultDoctype
    &lt;html&gt;
      #TurbineHtmlHead()
      &lt;body #TurbineHtmlBodyAttributes() &gt;
      $navigation.setTemplate(&quot;default_header.vm&quot;)
      $screen_placeholder
      $navigation.setTemplate(&quot;default_footer.vm&quot;)

      &lt;/body&gt;
    &lt;/html&gt;

</pre></div>

<p>
    This produces the same code as the following sample layout
    template that you can use:
</p>
	
<div class="source">
<pre>

    ## Set defaults for all pages using this layout.  Anything set here can
    ## be overridden in the screen template.
    $page.setTitle(&quot;My default page title&quot;);
    $page.setHttpEquiv(&quot;Content-Style-Type&quot;,&quot;text/css&quot;)
    $page.addStyleSheet($content.getURI(&quot;myStyleSheet.css&quot;))
    $page.addScript($content.getURI(&quot;globalJavascriptCode.js&quot;))
    ## build the HTML, HEAD, and BODY tags dynamically

    $page.DefaultDoctype
    &lt;html&gt;
      &lt;head&gt;
        #if($page.Title != &quot;&quot;)
        &lt;title&gt;$page.Title&lt;/title&gt;
        #end
        #foreach($metaTag in $page.MetaTags.keySet())
        &lt;meta name=&quot;$metaTag&quot; content=&quot;$page.MetaTags.get($metaTag)&quot;&gt;
        #end
        #foreach($httpEquiv in $page.HttpEquivs.keySet())
        &lt;meta http-equiv=&quot;$httpEquiv&quot; content=&quot;$page.HttpEquivs.get($httpEquiv)&quot;&gt;
        #end
        #foreach($styleSheet in $page.StyleSheets)
          &lt;link rel=&quot;stylesheet&quot; href=&quot;$styleSheet.Url&quot;
            #if($styleSheet.Type != &quot;&quot; ) type=&quot;$styleSheet.Type&quot; #end
            #if($styleSheet.Media != &quot;&quot;) media=&quot;$styleSheet.Media&quot; #end
            #if($styleSheet.Title != &quot;&quot;) title=&quot;$styleSheet.Title&quot; #end
          &gt;
        #end
        #if ($page.Styles.size() &gt; 0)
          &lt;style type=&quot;text/css&quot;&gt;
          #foreach( $style in $page.Styles )
            $!style
          #end
          &lt;/style&gt;
        #end
        #foreach($script in $page.Scripts)
          &lt;script type=&quot;text/javascript&quot; src=&quot;$script&quot; language=&quot;JavaScript&quot;&gt;&lt;/script&gt;
        #end
      &lt;/head&gt;

      ## Construct the body tag.  Iterate through the body attributes to build the opening tag
      &lt;body
        #foreach($attributeName in $page.BodyAttributes.keySet())
          $attributeName = &quot;$page.BodyAttributes.get($attributeName)&quot;
        #end
      &gt;

      $navigation.setTemplate(&quot;default_header.vm&quot;)
      $screen_placeholder
      $navigation.setTemplate(&quot;default_footer.vm&quot;)

      &lt;/body&gt;
    &lt;/html&gt;

</pre></div>
</div>


<div class="section">
<h2><a name="Writing_Directly_To_ServletOutputStream"></a>Writing Directly To ServletOutputStream</h2>

<p>
    See
	<a class="externalLink" href="http://wiki.apache.org/turbine/Turbine2/VelocityOnlyLayout">
	VelocityOnlyLayout</a> on the Turbine wiki for some information concerning
	writing directly to ServletOutputStream.
</p>
</div>


<div class="section">
<h2><a name="Updates_to_this_document"></a>Updates to this document</h2>

<p>
    This document is by no means complete or totally accurate. We welcome
    suggestions as to how it might be improved, particularly if you have
    just completed updating an application by following this howto.
</p>
</div>



      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2000&#x2013;2019 <a href="https://www.apache.org/">The Apache Software Foundation</a>.
All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>