<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Turbine - Services Howto</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Henning P. Schmiedehausen"></meta><meta name="email" content="hps@intermeta.de"></meta><meta name="author" content="Matt Koranda"></meta><meta name="email" content="matt@orkan.no"></meta></head><body class="composite"><div id="banner"><a href="http://turbine.apache.org/" id="organizationLogo"><img alt="Apache Software Foundation" src="../images/turbine-project.png"></img></a><a href="http://turbine.apache.org/turbine/turbine-2.3.3/index.html" id="projectLogo"><img alt="turbine-2" src="../images/logo.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 21 November 2008
                <span class="separator">|</span> Doc for  2.3.3
                </div><div class="xright">
        
        <a href="http://turbine.apache.org/">Turbine Home</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/fulcrum/">Fulcrum</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/meta/">META</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuGeneral_Information"><h5>General Information</h5><ul><li class="none"><a href="../index.html">Overview</a></li><li class="none"><a href="../features.html">Features</a></li><li class="none"><a href="../fsd.html">Specification</a></li><li class="none"><a href="../getting-started.html">Getting Started</a></li></ul></div><div id="menuDocumentation"><h5>Documentation</h5><ul><li class="none"><a href="../changes-report.html">Changes</a></li><li class="none"><a href="../turbine-schema.html">Core DB Schema</a></li><li class="collapsed"><a href="../services/index.html">Services</a></li><li class="expanded"><a href="../howto/index.html">Howtos</a><ul><li class="none"><a href="../howto/action-event-howto.html">Action Events Howto</a></li><li class="none"><a href="../howto/configuration-howto.html">Configuration Howto</a></li><li class="none"><a href="../howto/extend-user-howto.html">Extend User Howto</a></li><li class="none"><a href="../howto/hibernate-howto.html">Hibernate OM Howto</a></li><li class="none"><a href="../howto/intake-howto.html">Intake Howto</a></li><li class="none"><a href="../howto/jboss-howto.html">JBoss Howto</a></li><li class="none"><a href="../howto/jsp-howto.html">JSP Howto</a></li><li class="none"><a href="../howto/migrate-from-2_1-howto.html">Migrating 2.1 to 2.2</a></li><li class="none"><a href="../howto/migrate-from-2_2-howto.html">Migrating 2.2 to 2.3</a></li><li class="none"><a href="../howto/pullmodel-howto.html">Pull Model Howto</a></li><li class="none"><a href="../howto/python-howto.html">Python Howto</a></li><li class="none"><a href="../howto/security-howto.html">Security Howto</a></li><li class="none"><strong><a href="../howto/services-howto.html">Services Howto</a></strong></li><li class="none"><a href="../howto/sql-howto.html">How to build the SQL files</a></li><li class="none"><a href="../howto/url-rewriting-howto.html">URL rewriting Howto</a></li><li class="none"><a href="../howto/context-howto.html">Velocity Context Howto</a></li><li class="none"><a href="../howto/velocity-site-howto.html">Velocity Site Howto</a></li><li class="none"><a href="../howto/velocityonlylayout-howto.html">VelocityOnlyLayout Howto</a></li><li class="none"><a href="http://wiki.apache.org/turbine/Turbine2" class="externalLink" title="External Link">Wiki Howtos</a></li></ul></li><li class="none"><a href="../apidocs/index.html">JavaDocs</a></li></ul></div><div id="menuDevelopment"><h5>Development</h5><ul><li class="none"><a href="../proposals.html">Proposals</a></li><li class="none"><a href="../how-to-help.html">How To Help</a></li><li class="none"><a href="../todo.html">Todo</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="../development-process.html">Development Process</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/mavenlogo_builtby_w.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Turbine_Services_Creation"></a><h2>Turbine Services Creation</h2>
    <p>
      Adding your own services to Turbine is an easy task. Simply make your
      class extend <b>org.apache.turbine.services.TurbineBaseService</b>.
      This is necessary so that the Turbine Service Broker can start up
      your service.
    </p>

    <p>
      To make it known to the Turbine itself, you must configure it in
      the TurbineResources.properties like this:


    <div class="source"><pre>
services.MyServiceName.classname = full.class.name.of.your.service
</pre></div>
  
    </p>

    <p>
      and you're set, Turbine will now initialize the service if it is
      requested by an application. Please be aware that your service is
      <b>not</b> initialized right at Startup. This is called lazy init.
      If you need your Service to start up right away, you must add another
      property to the TurbineResources.properties:


    <div class="source"><pre>
services.MyServiceName.earlyInit = true
</pre></div>
  
    </p>

    <p>
      If you look at the examples of the simple services like
      db/TurbinePoolBrokerService or servlet/TurbineServletService you'll
      get on speed pretty fast.
    </p>
</div><div class="section"><a name="In_a_Nutshell"></a><h2>In a Nutshell</h2>
    <p>
      <ul>
        <li>
          You must not try to provide a constructor with parameters, best is
          not to provide any constructor at all, because nothing should be
          done at construction time (You'll get the default constructor which
          is fine for us).
         </li>
         <li>
           Your Service will be instantiated exactly once. So it must be
           threadsafe and must not use class global variables for
           session-dependent information.
         </li>
         <li>
           You should provide an init() method which is called when your
           service is requested for the first time (or at startup if you
           set earlyInit = true) and should initialize your service
           dependent code. There is lots of confusion of how this init()
           method should look like because Turbine used different methods
           of Service initialization. Beginning with Turbine 2.2, you should
           only use the parameterless variant:
         </li>
      </ul>
    </p>

    <div class="source"><pre>
public void init() throws InitializationException
{
}
</pre></div>
  
    <p>
      <ul>
        <li>
          You <b>must</b> call setInit(true) if your service initializes
          correctly. Otherwise no user of your service can request it.
          Right after this, your service might be queried and used by other
          sessions, so you should not call setInit() prematurely.
        </li>
        <li>
          You might provide a shutdown() method which is called when
          Turbine shuts down. You can clean up your internal data in this
          method. You should call setInit(false) as the last thing in
          shutdown().
        </li>
      </ul>
    </p>
</div><div class="section"><a name="Style"></a><h2>Style</h2>
    <p>
      It is good style, that if you build the FooService, to provide
      <b>your.package.FooService.java</b> with an Interface definition of
      your service which extends <b>org.apache.turbine.services.Service</b>
      It should contain a constant SERVICE_NAME with the Turbine visible
      name of your service like this:

    <div class="source"><pre>
package your.package;

import org.apache.turbine.services.Service;

public interface FooService extends Service
{
    /**
     * The service identifier
     */
    public String SERVICE_NAME = "FooService";

    [...]

}
</pre></div>
  
    </p>

    <p>
      <b>your.package.TurbineFooService.java</b> which extends the
      <b>org.apache.turbine.services.TurbineBaseService</b> class and
      implements <b>your.package.FooService</b> and provides the actual code:
    </p>


    <div class="source"><pre>
package your.package;

import org.apache.turbine.services.TurbineBaseService;

public class TurbineFooService
    extends TurbineBaseService
    implements FooService
{
    /**
     * Service logic here
     */
    [...]

}
</pre></div>
  

    <p>
      <b>your.package.TurbineFoo.java</b> which contains static facade
      methods for your service along the following lines:


    <div class="source"><pre>
import org.apache.turbine.services.TurbineServices;

public class TurbineFoo
{
    protected static FooService getService()
    {
        return (FooService) TurbineServices
            .getInstance().getService(FooService.SERVICE_NAME);
    }

    [...]

    public static void fooMethod1()
    {
        getService().fooMethod1();
    }

    public static int fooMethod2(int bar)
    {
        return getService().fooMethod2(bar);
    }

    [...]

}
</pre></div>
  
    </p>

    <p>
      to give users of your service the ability to simply write:


    <div class="source"><pre>
TurbineFoo.fooMethod1();
</pre></div>
  
    </p>

    <p>
      in their code and not to care about which actual Implementation of
      FooService is running.
    </p>

    <p>
      init() and shutdown() applies to Turbine 2.1/2.2 This might change
      with the lifecycle interfaces in a later release.
    </p>
</div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2000-2008, Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>