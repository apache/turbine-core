<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Turbine - URL Rewriting Howto</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Gareth Coltman"></meta><meta name="email" content=""></meta></head><body class="composite"><div id="banner"><a href="http://turbine.apache.org/" id="organizationLogo"><img alt="Apache Software Foundation" src="../images/turbine-project.png"></img></a><a href="http://turbine.apache.org/turbine/turbine-2.3.3/index.html" id="projectLogo"><img alt="turbine-2" src="../images/logo.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 21 November 2008
                <span class="separator">|</span> Doc for  2.3.3
                </div><div class="xright">
        
        <a href="http://turbine.apache.org/">Turbine Home</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/fulcrum/">Fulcrum</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://turbine.apache.org/meta/">META</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuGeneral_Information"><h5>General Information</h5><ul><li class="none"><a href="../index.html">Overview</a></li><li class="none"><a href="../features.html">Features</a></li><li class="none"><a href="../fsd.html">Specification</a></li><li class="none"><a href="../getting-started.html">Getting Started</a></li></ul></div><div id="menuDocumentation"><h5>Documentation</h5><ul><li class="none"><a href="../changes-report.html">Changes</a></li><li class="none"><a href="../turbine-schema.html">Core DB Schema</a></li><li class="collapsed"><a href="../services/index.html">Services</a></li><li class="expanded"><a href="../howto/index.html">Howtos</a><ul><li class="none"><a href="../howto/action-event-howto.html">Action Events Howto</a></li><li class="none"><a href="../howto/configuration-howto.html">Configuration Howto</a></li><li class="none"><a href="../howto/extend-user-howto.html">Extend User Howto</a></li><li class="none"><a href="../howto/hibernate-howto.html">Hibernate OM Howto</a></li><li class="none"><a href="../howto/intake-howto.html">Intake Howto</a></li><li class="none"><a href="../howto/jboss-howto.html">JBoss Howto</a></li><li class="none"><a href="../howto/jsp-howto.html">JSP Howto</a></li><li class="none"><a href="../howto/migrate-from-2_1-howto.html">Migrating 2.1 to 2.2</a></li><li class="none"><a href="../howto/migrate-from-2_2-howto.html">Migrating 2.2 to 2.3</a></li><li class="none"><a href="../howto/pullmodel-howto.html">Pull Model Howto</a></li><li class="none"><a href="../howto/python-howto.html">Python Howto</a></li><li class="none"><a href="../howto/security-howto.html">Security Howto</a></li><li class="none"><a href="../howto/services-howto.html">Services Howto</a></li><li class="none"><a href="../howto/sql-howto.html">How to build the SQL files</a></li><li class="none"><strong><a href="../howto/url-rewriting-howto.html">URL rewriting Howto</a></strong></li><li class="none"><a href="../howto/context-howto.html">Velocity Context Howto</a></li><li class="none"><a href="../howto/velocity-site-howto.html">Velocity Site Howto</a></li><li class="none"><a href="../howto/velocityonlylayout-howto.html">VelocityOnlyLayout Howto</a></li><li class="none"><a href="http://wiki.apache.org/turbine/Turbine2" class="externalLink" title="External Link">Wiki Howtos</a></li></ul></li><li class="none"><a href="../apidocs/index.html">JavaDocs</a></li></ul></div><div id="menuDevelopment"><h5>Development</h5><ul><li class="none"><a href="../proposals.html">Proposals</a></li><li class="none"><a href="../how-to-help.html">How To Help</a></li><li class="none"><a href="../todo.html">Todo</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="../development-process.html">Development Process</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/mavenlogo_builtby_w.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Scenario_and_Overview"></a><h2>Scenario and Overview</h2>

<p>
Unaltered Turbine URLs look like this:
<code>http://www.foo.com:8080/CONTEXT/servlet/MAPPING/template/Foo.vm</code>.<br></br>
But you want shorter URLs, or you don't like exposing the use of
servlets in the URL.  Maybe this url would suit you better:
<code>http://www.foo.com:8080/po/s/la/template/Foo.vm</code>
</p>

<p>
The bulk of the url is defined by the servlet api and is outside of the
control of Turbine:
<pre>
http://www.foo.com/CONTEXT/servlet/MAPPING/template/Foo.vm
                   [ servlet api defined ][ turbine       ]</pre>

This HOWTO describes how you can control the servlet part of the url
in Tomcat.  For other servlet environments you'll have to consult
their documentation.
</p>

<p>
Three parts of the url will be addressed:
<ol>
<li>the web application context (CONTEXT in the example above),</li>
<li>the servlet prefix (servlet),</li>
<li>and the servlet mapping (MAPPING).</li>
</ol>
</p>

</div><div class="section"><a name="The_Context"></a><h2>The Context</h2>

<p>
You need to register the context with Tomcat. If you have given your
application a short name like 'po' and placed it correctly in the
webapps directory, then you won't need to do anything special. Tomcat
will find the directory, and add a context. If you have a long
application name like 'mywonderfulapp', add the following lines to
Tomcat's server.xml file (in the TDK you'll find this here:
<code>tdk/conf/server.xml</code>):
</p>


    <div class="source"><pre>
&lt;Context
    path="/po"
    docBase="webapps/mywonderfulapp"
    reloadable="true"
    debug="0"
    trusted="false" &gt;
&lt;/Context&gt;
</pre></div>
  

<p>
Everything after the docBase= line is obviously up to you. This tells
Tomcat to add a context named 'po' with the docbase of your
application.
</p>

</div><div class="section"><a name="The_Servlet_Prefix"></a><h2>The Servlet Prefix</h2>

<p>
Modifying the servlet prefix also requires editing Tomcat's server.xml
file.  Tomcat will use this prefix to determine if a given request is
for a servlet.  Edit the following lines:
</p>


    <div class="source"><pre>
&lt;RequestInterceptor
    className="org.apache.tomcat.request.InvokerInterceptor"
    debug="0" prefix="/s/" /&gt;
</pre></div>
  

<p>
With this modification, Tomcat recognize requests containing /s/ in
the url as a servlet request and will look for the servlet in the
web.xml descriptor.
</p>

</div><div class="section"><a name="The_Servlet_Name"></a><h2>The Servlet Name</h2>
<p>
This is defined in web.xml (which you will find here:
<code>webapps/WEB-INF/web.xml</code>).  This is automatically given
the name of your application in Turbine.  To change it, simply edit the
web.xml file as follows:
</p>


    <div class="source"><pre>
&lt;servlet-name&gt;
    la
&lt;/servlet-name&gt;
</pre></div>
  

<p>
<strong>If you are using Tomcat standalone, then you are done and your url is
now <code>http://servername:port:/po/s/la</code></strong>
</p>

</div><div class="section"><a name="If_you_are_running_Apache_and_mod_jk"></a><h2>If you are running Apache and mod_jk</h2>

<p>
... you will need to change your mod_jk.conf file to include the following:
</p>


    <div class="source"><pre>
#########################################################
# Auto configuration for the /po context starts.
#########################################################

#
# Make Apache aware of the location of the context
#
Alias /po "serverroot/webapps/mywonderfulapp"
&lt;Directory "serverroot/webapps/mywonderfulapp"&gt;
     Options Indexes FollowSymLinks
&lt;/Directory&gt;

#
# Mount all JSP files and the /servlet/ uri to Tomcat
#
JkMount /po/s/* ajp12
JkMount /po/*.jsp ajp12

#
# Prohibit users from directly accessing WEB-INF
#
&lt;Location "/mywonderfulapp/WEB-INF/"&gt;
     AllowOverride None
     deny from all
&lt;/Location&gt;

#
# Prohibit users from directly accessing META-INF
#
&lt;Location "/mywonderfulapp/META-INF/"&gt;
     AllowOverride None
     deny from all
&lt;/Location&gt;

#######################################################
# Auto configuration for the /po context ends.
#######################################################
</pre></div>
  

<p>
document created August 14, 2001
</p>

</div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2000-2008, Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>